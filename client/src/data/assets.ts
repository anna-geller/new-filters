import type { AssetRecord } from "@/types/assets";
import { composeAssetKey } from "@/utils/assetKeys";

export const ASSETS: AssetRecord[] = [
  {
    id: "my_ec2",
    type: "VM",
    namespace: "company.team",
    displayName: "My VM",
    description:
      "## Production compute node\n\nRuns the payment ingestion path and is patched nightly via the `hardenVM` flow.\n- Anchored to cluster capacity window\n- Emits health metrics to Grafana",
    values: {
      namespace: "company.team",
      primaryFlow: "provisionVM",
      status: "ON",
      cloud: "AWS",
      region: "us-east-1",
      maintainer: "faizan",
      createdAt: "2024-02-14T11:32:00Z",
      ip: "192.0.2.10",
    },
    relatedAssets: ["company.platform/cluster_1", "company.platform/region_us_east_1"],
    relatedApps: ["request_data_form"],
    relatedFlows: [
      { namespace: "company.team", flow: "provisionVM" },
      { namespace: "company.team", flow: "hardenVM" },
      { namespace: "company.team", flow: "shutDownVM" },
    ],
    executions: [
      {
        id: "exec_90231",
        namespace: "company.team",
        flow: "provisionVM",
        taskId: "launch_ec2",
        status: "SUCCESS",
        timestamp: "2024-06-02T18:42:00Z",
        note: "Provisioned instance and registered asset",
      },
      {
        id: "exec_88741",
        namespace: "company.team",
        flow: "hardenVM",
        taskId: "apply_patches",
        status: "RUNNING",
        timestamp: "2024-05-30T20:13:00Z",
        note: "Security patches running",
      },
      {
        id: "exec_86103",
        namespace: "company.team",
        flow: "shutDownVM",
        taskId: "stop_instance",
        status: "FAILED",
        timestamp: "2024-05-14T16:08:00Z",
        note: "Shutdown skipped â€“ VM flagged as critical",
      },
    ],
  },
  {
    id: "products_csv_s3",
    type: "Dataset",
    namespace: "company.team",
    displayName: "Products CSV on S3",
    description:
      "Daily export of the merchandising catalog prepared for analytics teams.\n\n- Source: `products_csv_source`\n- Refresh cadence: every weekday at 12:45 UTC\n- Retained for 30 days in the bucket lifecycle policy",
    values: {
      namespace: "company.team",
      primaryFlow: "csv_to_s3_lineage",
      cloud: "AWS",
      bucket: "s3://my-bucket",
      key: "data/products.csv",
      status: "ON",
      lastShipped: "2024-05-27T12:45:00Z",
    },
    relatedAssets: ["company.analytics/products_csv_source"],
    relatedApps: ["data_quality_dashboard"],
    relatedFlows: [
      { namespace: "company.team", flow: "csv_to_s3_lineage" },
      { namespace: "company.analytics", flow: "refreshProductInventory" },
    ],
    executions: [
      {
        id: "exec_90511",
        namespace: "company.team",
        flow: "csv_to_s3_lineage",
        taskId: "load_to_s3",
        status: "SUCCESS",
        timestamp: "2024-05-27T12:45:00Z",
        note: "Dataset synced to S3 bucket",
      },
      {
        id: "exec_89942",
        namespace: "company.analytics",
        flow: "refreshProductInventory",
        taskId: "quality_gate",
        status: "SUCCESS",
        timestamp: "2024-05-24T09:26:00Z",
        note: "Quality checks passed before publishing",
      },
    ],
  },
  {
    id: "cluster_1",
    type: "Cluster",
    namespace: "company.platform",
    displayName: "Production Compute Cluster",
    description:
      "Primary compute backbone for frontend and integration workloads.\n\n- Scaled automatically by the `scaleOutCluster` flow\n- Provides reserved capacity for incident response runbooks",
    values: {
      namespace: "company.platform",
      primaryFlow: "scaleOutCluster",
      status: "DEGRADED",
      cloud: "AWS",
      region: "us-east-1",
      nodes: "24",
      lastAudit: "2024-05-30T05:30:00Z",
    },
    relatedAssets: ["company.platform/region_us_east_1", "company.team/my_ec2"],
    relatedApps: ["capacity_alerts"],
    relatedFlows: [
      { namespace: "company.platform", flow: "bootstrapCluster" },
      { namespace: "company.platform", flow: "scaleOutCluster" },
    ],
    executions: [
      {
        id: "exec_81234",
        namespace: "company.platform",
        flow: "scaleOutCluster",
        taskId: "add_nodes",
        status: "RUNNING",
        timestamp: "2024-06-03T09:15:00Z",
        note: "Waiting for new nodes to register",
      },
      {
        id: "exec_80555",
        namespace: "company.platform",
        flow: "bootstrapCluster",
        taskId: "init_cluster",
        status: "SUCCESS",
        timestamp: "2023-11-10T11:33:00Z",
        note: "Cluster created",
      },
    ],
  },
  {
    id: "products_csv_source",
    type: "Dataset",
    namespace: "company.analytics",
    displayName: "Products CSV Source",
    values: {
      namespace: "company.analytics",
      primaryFlow: "downloadProducts",
      sourceUri: "https://huggingface.co/datasets/kestra/datasets/resolve/main/csv/cache_demo/products.csv",
      refreshCadence: "24h",
      format: "CSV",
    },
    relatedAssets: ["company.team/products_csv_s3"],
    relatedApps: ["lineage_observer"],
    relatedFlows: [
      { namespace: "company.analytics", flow: "downloadProducts" },
      { namespace: "company.team", flow: "csv_to_s3_lineage" },
    ],
  },
  {
    id: "region_us_east_1",
    type: "Region",
    namespace: "company.platform",
    displayName: "Region us-east-1",
    values: {
      namespace: "company.platform",
      primaryFlow: "registerRegion",
      cloud: "AWS",
      accounts: "15",
      compliance: "SOC 2 Type II",
      regionsLinked: "3",
    },
    relatedAssets: ["company.platform/cluster_1", "company.team/my_ec2"],
    relatedApps: ["cost_monitoring"],
    relatedFlows: [
      { namespace: "company.platform", flow: "registerRegion" },
      { namespace: "company.platform", flow: "scaleOutCluster" },
    ],
  },
  {
    id: "customer_events_stream",
    type: "Stream",
    namespace: "company.platform",
    displayName: "Customer Events Stream",
    description:
      "High-volume Kafka topic carrying customer interactions from web and mobile channels.\n\n- Multi-region producers with 24 partitions\n- Enriched downstream by the `customer_360_build` flow\n- Retention tuned for 72 hours to balance freshness and cost",
    values: {
      namespace: "company.platform",
      primaryFlow: "customer_events_stream_ingest",
      status: "ON",
      partitions: 24,
      retentionHours: 72,
      transport: "Kafka",
    },
    relatedAssets: [
      "company.analytics/customer_profile_db",
      "company.analytics/customer_360_warehouse",
      "company.platform/region_us_east_1",
    ],
    relatedApps: ["customer_insights_dashboard"],
    relatedFlows: [
      { namespace: "company.platform", flow: "customer_events_stream_ingest" },
      { namespace: "company.analytics", flow: "customer_360_build" },
    ],
    executions: [
      {
        id: "exec_93012",
        namespace: "company.platform",
        flow: "customer_events_stream_ingest",
        taskId: "consume_batch",
        status: "SUCCESS",
        timestamp: "2024-06-03T06:04:00Z",
        note: "Batch of 1.2M events processed",
      },
      {
        id: "exec_92881",
        namespace: "company.analytics",
        flow: "customer_360_build",
        taskId: "merge_stream_stage",
        status: "RUNNING",
        timestamp: "2024-06-02T23:50:00Z",
        note: "Joining with daily aggregates",
      },
    ],
  },
  {
    id: "customer_profile_db",
    type: "Database",
    namespace: "company.analytics",
    displayName: "Customer Profile Database",
    values: {
      namespace: "company.analytics",
      primaryFlow: "customer_support_case_enrich",
      engine: "PostgreSQL",
      status: "ON",
      storageTier: "gold",
      sizeGb: 820,
    },
    relatedAssets: [
      "company.platform/customer_events_stream",
      "company.analytics/customer_360_warehouse",
    ],
    relatedApps: ["customer_success_portal"],
    relatedFlows: [
      { namespace: "company.support", flow: "customer_support_case_enrich" },
      { namespace: "company.analytics", flow: "customer_360_build" },
    ],
    executions: [
      {
        id: "exec_92210",
        namespace: "company.support",
        flow: "customer_support_case_enrich",
        taskId: "enrich_records",
        status: "SUCCESS",
        timestamp: "2024-06-01T14:18:00Z",
        note: "Updated 4.2k support cases",
      },
    ],
  },
  {
    id: "customer_360_warehouse",
    type: "Dataset",
    namespace: "company.analytics",
    displayName: "Customer 360 Warehouse",
    values: {
      namespace: "company.analytics",
      primaryFlow: "customer_360_build",
      layer: "gold",
      status: "ON",
      refreshedAt: "2024-06-03T05:30:00Z",
      tables: 18,
    },
    relatedAssets: [
      "company.platform/customer_events_stream",
      "company.analytics/customer_profile_db",
      "company.team/products_csv_s3",
    ],
    relatedApps: ["customer_insights_dashboard", "customer_success_portal"],
    relatedFlows: [
      { namespace: "company.analytics", flow: "customer_360_build" },
      { namespace: "company.analytics", flow: "refreshProductInventory" },
      { namespace: "company.support", flow: "customer_support_case_enrich" },
    ],
    executions: [
      {
        id: "exec_94001",
        namespace: "company.analytics",
        flow: "customer_360_build",
        taskId: "publish_gold",
        status: "SUCCESS",
        timestamp: "2024-06-03T05:30:00Z",
        note: "Warehouse snapshot published for BI consumers",
      },
      {
        id: "exec_93655",
        namespace: "company.analytics",
        flow: "refreshProductInventory",
        taskId: "join_inventory",
        status: "SUCCESS",
        timestamp: "2024-06-02T22:11:00Z",
        note: "Aligned product inventory metrics to customer view",
      },
    ],
  },
  {
    id: "feature_flag_archive",
    type: "Config",
    namespace: "company.platform",
    displayName: "Feature Flag Archive",
    values: {
      namespace: "company.platform",
      status: "READY",
      storage: "S3",
      retentionDays: 30,
    },
    relatedAssets: [],
    relatedApps: [],
    relatedFlows: [],
  },
  {
    id: "orphan_backup_snapshot",
    type: "Snapshot",
    namespace: "company.platform",
    displayName: "Orphaned Backup Snapshot",
    values: {
      namespace: "company.platform",
      createdAt: "2024-05-20T02:42:00Z",
      sizeGb: 56,
      status: "ARCHIVED",
    },
    relatedAssets: [],
    relatedApps: [],
    relatedFlows: [],
  },
];

export const assetsById = ASSETS.reduce<Record<string, AssetRecord>>((acc, asset) => {
  acc[composeAssetKey(asset.namespace, asset.id)] = asset;
  return acc;
}, {});
